{
  "alerts": [
    {
      "id": "9fe76e37-77a6-43a7-8581-485ff8024fa1",
      "policy": {
        "id": "9548bd05-d508-4129-b4ad-47e5c3faec90",
        "name": "abcd",
        "severity": "MEDIUM_SEVERITY",
        "description": "",
        "rationale": "",
        "remediation": "",
        "disabled": false,
        "categories": [
          "Container Configuration"
        ],
        "scope": [],
        "enforcement": "UNSET_ENFORCEMENT",
        "notifiers": [],
        "imagePolicy": {
          "imageName": {
            "registry": "docker.io",
            "namespace": "",
            "repo": "",
            "tag": ""
          },
          "lineRule": null,
          "cvss": null,
          "cve": "",
          "component": null
        },
        "privilegePolicy": null,
        "configurationPolicy": null,
        "whitelists": []
      },
      "deployment": {
        "id": "rkxftf0o74jw7mp7ekjuam7ts",
        "name": "prevent_sensor",
        "version": "18009",
        "type": "Replicated",
        "namespace": "prevent",
        "replicas": "1",
        "labels": [
          {
            "key": "com.docker.stack.image",
            "value": "stackrox/prevent:1.0-22-g8510c05"
          },
          {
            "key": "com.docker.stack.namespace",
            "value": "prevent"
          },
          {
            "key": "email",
            "value": "support@stackrox.com"
          },
          {
            "key": "owner",
            "value": "stackrox"
          }
        ],
        "updatedAt": "2018-05-14T20:34:09.774792860Z",
        "clusterId": "bbb84f57-b68e-4f7a-bf11-eb161e043b5b",
        "clusterName": "remote",
        "containers": [
          {
            "config": {
              "env": [
                {
                  "key": "ROX_CENTRAL_ENDPOINT",
                  "value": "central.prevent_net:443"
                },
                {
                  "key": "ROX_PREVENT_ADVERTISED_ENDPOINT",
                  "value": "sensor.prevent_net:443"
                },
                {
                  "key": "ROX_PREVENT_CLUSTER_ID",
                  "value": "bbb84f57-b68e-4f7a-bf11-eb161e043b5b"
                },
                {
                  "key": "ROX_PREVENT_IMAGE",
                  "value": "stackrox/prevent:1.0-22-g8510c05"
                }
              ],
              "command": [
                "swarm-sensor"
              ],
              "args": [],
              "directory": "",
              "user": "",
              "uid": "0"
            },
            "image": {
              "name": {
                "sha": "sha256:f5cc91c8b7efab476e165c66007cb2a61ef450975ea10b30b3eb9385011115ec",
                "registry": "docker.io",
                "remote": "stackrox/prevent",
                "tag": "1.0-22-g8510c05",
                "fullName": "docker.io/stackrox/prevent:1.0-22-g8510c05"
              },
              "metadata": null,
              "scan": null
            },
            "securityContext": null,
            "volumes": [
              {
                "name": "/var/run/docker.sock",
                "source": "/var/run/docker.sock",
                "destination": "/var/run/docker.sock",
                "readOnly": false,
                "type": "bind"
              },
              {
                "name": "prevent_central_certificate",
                "source": "",
                "destination": "/run/secrets/stackrox.io/ca.pem",
                "readOnly": false,
                "type": "secret"
              },
              {
                "name": "prevent_registry_auth",
                "source": "",
                "destination": "/run/secrets/stackrox.io/registry_auth",
                "readOnly": false,
                "type": "secret"
              },
              {
                "name": "prevent_sensor_certificate",
                "source": "",
                "destination": "/run/secrets/stackrox.io/cert.pem",
                "readOnly": false,
                "type": "secret"
              },
              {
                "name": "prevent_sensor_private_key",
                "source": "",
                "destination": "/run/secrets/stackrox.io/key.pem",
                "readOnly": false,
                "type": "secret"
              }
            ],
            "ports": []
          }
        ],
        "risk": {
          "score": 1.375,
          "results": [
            {
              "name": "Service Configuration",
              "factors": [
                "Volumes /var/run/docker.sock were mounted RW",
                "Secrets prevent_central_certificate, prevent_registry_auth, prevent_sensor_certificate, prevent_sensor_private_key are used inside the deployment",
                "No capabilities were dropped"
              ],
              "score": 1.375
            }
          ]
        },
        "tombstone": null,
        "annotations": []
      },
      "violations": [
        {
          "message": "Image name 'docker.io/stackrox/prevent:1.0-22-g8510c05' matches the name policy 'registry=docker.io'",
          "link": ""
        }
      ],
      "enforcement": null,
      "time": "2018-05-14T20:36:22.901652616Z",
      "stale": false,
      "markedStale": null
    },
    {
      "id": "a15c73e5-80bd-4db1-8d3d-013013309402",
      "policy": {
        "id": "9548bd05-d508-4129-b4ad-47e5c3faec90",
        "name": "abcd",
        "severity": "MEDIUM_SEVERITY",
        "description": "",
        "rationale": "",
        "remediation": "",
        "disabled": false,
        "categories": [
          "Container Configuration"
        ],
        "scope": [],
        "enforcement": "UNSET_ENFORCEMENT",
        "notifiers": [],
        "imagePolicy": {
          "imageName": {
            "registry": "docker.io",
            "namespace": "",
            "repo": "",
            "tag": ""
          },
          "lineRule": null,
          "cvss": null,
          "cve": "",
          "component": null
        },
        "privilegePolicy": null,
        "configurationPolicy": null,
        "whitelists": []
      },
      "deployment": {
        "id": "amab3m0c5v1y3tgp052tl846l",
        "name": "prevent_central",
        "version": "17997",
        "type": "Replicated",
        "namespace": "prevent",
        "replicas": "1",
        "labels": [
          {
            "key": "com.docker.stack.image",
            "value": "stackrox/prevent:1.0-22-g8510c05"
          },
          {
            "key": "com.docker.stack.namespace",
            "value": "prevent"
          },
          {
            "key": "email",
            "value": "support@stackrox.com"
          },
          {
            "key": "owner",
            "value": "stackrox"
          }
        ],
        "updatedAt": "2018-05-14T20:34:01.184220296Z",
        "clusterId": "bbb84f57-b68e-4f7a-bf11-eb161e043b5b",
        "clusterName": "remote",
        "containers": [
          {
            "config": {
              "env": [],
              "command": [
                "central"
              ],
              "args": [],
              "directory": "",
              "user": "",
              "uid": "0"
            },
            "image": {
              "name": {
                "sha": "sha256:f5cc91c8b7efab476e165c66007cb2a61ef450975ea10b30b3eb9385011115ec",
                "registry": "docker.io",
                "remote": "stackrox/prevent",
                "tag": "1.0-22-g8510c05",
                "fullName": "docker.io/stackrox/prevent:1.0-22-g8510c05"
              },
              "metadata": null,
              "scan": null
            },
            "securityContext": null,
            "volumes": [
              {
                "name": "prevent_prevent_certificate",
                "source": "",
                "destination": "/run/secrets/stackrox.io/ca.pem",
                "readOnly": false,
                "type": "secret"
              },
              {
                "name": "prevent_prevent_private_key",
                "source": "",
                "destination": "/run/secrets/stackrox.io/ca-key.pem",
                "readOnly": false,
                "type": "secret"
              }
            ],
            "ports": [
              {
                "name": "",
                "containerPort": 443,
                "protocol": "tcp",
                "exposure": "EXTERNAL"
              }
            ]
          }
        ],
        "risk": {
          "score": 1.625,
          "results": [
            {
              "name": "Service Reachability",
              "factors": [
                "Container stackrox/prevent exposes port 443 to external clients"
              ],
              "score": 1.3
            },
            {
              "name": "Service Configuration",
              "factors": [
                "Secrets prevent_prevent_certificate, prevent_prevent_private_key are used inside the deployment",
                "No capabilities were dropped"
              ],
              "score": 1.25
            }
          ]
        },
        "tombstone": null,
        "annotations": []
      },
      "violations": [
        {
          "message": "Image name 'docker.io/stackrox/prevent:1.0-22-g8510c05' matches the name policy 'registry=docker.io'",
          "link": ""
        }
      ],
      "enforcement": null,
      "time": "2018-05-14T20:36:22.872485506Z",
      "stale": false,
      "markedStale": null
    }
  ]
}
